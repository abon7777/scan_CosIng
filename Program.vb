Imports System
Imports System.IO
Imports System.Text

Module Program
    Sub Main(args As String())
        Dim clArgs() As String = Environment.GetCommandLineArgs()
        Dim pa As String = ""
        If clArgs.Count() > 1 Then
            For i As Integer = 1 To clArgs.Count - 1 Step 2
                If clArgs(i) = "-p" Then
                    pa = clArgs(i + 1)
                End If
            Next
        End If

        If Not pa = "" Then
            If Not pa.EndsWith("\") Then pa &= "\"
            scancos(pa)
        Else
            Console.WriteLine("Usage: -p [html folder]")
        End If

    End Sub
    Structure cosingel
        Dim num As String
        Dim nam As String
        Dim lab As String
        Dim fie() As String
        Dim con() As String
    End Structure

    Function stritra(ByRef stringa As String, ByRef pre As String, ByRef post As String)
        Dim a As String = stringa
        If a.Contains(pre) Then a = a.Substring(InStr(a, pre) + Len(pre) - 1)
        If a.Contains(post) Then a = Strings.Left(a, InStr(a, post) - 1)
        Return a
    End Function
    Sub scancos(ByVal papa As String)
        Dim fon As String = papa
        Dim fob As New DirectoryInfo(fon)
        Dim fis() As FileInfo = fob.GetFiles("*.html")
        Dim els(fis.Length - 1) As cosingel
        Dim fies(-1) As String
        For f As Integer = 0 To fis.Length - 1
            els(f).num = Replace(fis(f).Name, ".html", "")
            Dim te() As String = File.ReadAllLines(fis(f).FullName)
            Dim tit = Array.Find(te, Function(s) s.Contains("harmonised__title"">"))
            tit = stritra(tit, "harmonised__title"">", "<")
            els(f).nam = tit
            els(f).lab = ""
            If els(f).nam.Contains(":") Then
                els(f).lab = Trim(Strings.Left(els(f).nam, InStr(els(f).nam, ":") - 1))
                els(f).nam = Trim(els(f).nam.Substring(InStr(els(f).nam, ":")))
            End If
            Dim tab As String = Array.Find(te, Function(s) s.Contains("ecl-table__row"">"))
            Dim lis() As String = Strings.Split(tab, "ecl-table__row"">")
            ReDim els(f).fie(lis.Length - 2)
            ReDim els(f).con(lis.Length - 2)
            For l As Integer = 1 To lis.Length - 1
                If lis(l).Contains("ecl-table__cell"">") Then
                    If lis(l).Contains("</td>") Then
                        els(f).fie(l - 1) = stritra(lis(l), "ecl-table__cell"">", "</td>")
                        lis(l) = lis(l).Substring(InStr(lis(l), "ecl-table__cell"">" & els(f).fie(l - 1)) + Len("ecl-table__cell"">" & els(f).fie(l - 1)))
                        els(f).fie(l - 1) = Trim(deht(els(f).fie(l - 1)))
                        els(f).con(l - 1) = Trim(deht(Replace(stritra(lis(l), "ecl-table__cell"">", "</td>"), "</li>", "|")))
                        If Not els(f).con(l - 1) Is Nothing AndAlso els(f).con(l - 1).EndsWith("|") Then els(f).con(l - 1) = Strings.Left(els(f).con(l - 1), Len(els(f).con(l - 1)) - 1)
                    Else
                        If lis(l).Contains("ecl-u-type-color-red") Then
                            els(f).fie(l - 1) = "Note-RED"
                            els(f).con(l - 1) = Trim(deht(Replace(stritra(lis(l), "ecl-table__cell"">", "</td>"), "</li>", "|")))
                        ElseIf lis(l).Contains("ecl-u-type-color-green") Then
                            els(f).fie(l - 1) = "Note-green"
                            els(f).con(l - 1) = Trim(deht(Replace(stritra(lis(l), "ecl-table__cell"">", "</td>"), "</li>", "|")))
                        End If
                    End If
                ElseIf lis(l).Contains("""ecl-table__header"">") Then
                    Dim cols() As String = Strings.Split(lis(l), """ecl-table__header"">")
                    For c As Integer = 1 To cols.Length - 1
                        Dim col As String = Strings.Left(cols(c), InStr(cols(c), "</th>") - 1)
                        If Not Trim(col) = "" Then
                            ReDim Preserve els(f).fie(els(f).con.Length)
                            ReDim Preserve els(f).con(els(f).con.Length)
                            els(f).fie(els(f).con.Length - 1) = Trim(deht(col))
                        End If
                    Next
                ElseIf lis(l).Contains("ecltablecell=""") Then
                    Dim cols() As String = Strings.Split(lis(l), "</td>")
                    Dim he As String = ""
                    Dim tu As String = ""
                    For Each col In cols
                        If col.Contains("data-ecl-table-header="""">") Then
                            he = Trim(stritra(col & """", "data-ecl-table-header="""">", """"))
                        ElseIf col.Contains("data-ecl-table-header=""") Then
                            Dim eh As String = stritra(col, "data-ecl-table-header=""", """")
                            Dim cox As Integer = Array.FindIndex(els(f).fie, Function(s) s = eh)
                            Dim nt As String = Trim(deht(col))
                            If Not nt = "" Then
                                tu = he & ":" & nt
                            Else
                                tu = ""
                            End If
                            If Not tu = "" Then
                                If els(f).con(cox) Is Nothing OrElse els(f).con(cox) = "" Then
                                    els(f).con(cox) = tu
                                Else
                                    els(f).con(cox) &= "|" & tu
                                End If
                            Else
                                l = l
                            End If
                        End If
                    Next
                Else
                    l = l
                End If
            Next
            fies = fies.Union(els(f).fie).ToArray
        Next

        Using w As New StreamWriter(fon & "table.txt")
            w.Write("ID" & vbTab & "label" & vbTab & "title")
            fies = fies.Except({"", Nothing}).ToArray
            For Each fi In fies
                w.Write(vbTab & fi)
            Next
            w.WriteLine()
            For Each el In els
                w.Write(el.num & vbTab & el.lab & vbTab & el.nam)
                For Each fi In fies
                    w.Write(vbTab) ''
                    Dim ix As Integer = Array.FindIndex(el.fie, Function(s) s = fi)
                    If Not ix = -1 AndAlso Not el.con(ix) Is Nothing AndAlso Not el.con(ix) = "" AndAlso Not el.con(ix).EndsWith(":") Then
                        w.Write(el.con(ix))
                    End If
                Next
                w.WriteLine()
            Next
        End Using
    End Sub

    Public Function deht(ByVal txt As String)
        'txt = Replace(txt, "&#xD;", vbCr)
        'txt = Replace(txt, "&#xA;", vbLf)
        txt = Replace(txt, "â€““", "—")
        txt = Replace(txt, "&#039;", """")
        txt = Replace(txt, "&#100;", "d")
        txt = Replace(txt, "&#101;", "e")
        txt = Replace(txt, "&#102;", "f")
        txt = Replace(txt, "&#103;", "g")
        txt = Replace(txt, "&#104;", "h")
        txt = Replace(txt, "&#105;", "i")
        txt = Replace(txt, "&#106;", "j")
        txt = Replace(txt, "&#107;", "k")
        txt = Replace(txt, "&#108;", "l")
        txt = Replace(txt, "&#109;", "m")
        txt = Replace(txt, "&#110;", "n")
        txt = Replace(txt, "&#111;", "o")
        txt = Replace(txt, "&#112;", "p")
        txt = Replace(txt, "&#113;", "q")
        txt = Replace(txt, "&#114;", "r")
        txt = Replace(txt, "&#115;", "s")
        txt = Replace(txt, "&#116;", "t")
        txt = Replace(txt, "&#117;", "u")
        txt = Replace(txt, "&#118;", "v")
        txt = Replace(txt, "&#119;", "w")
        txt = Replace(txt, "&#120;", "x")
        txt = Replace(txt, "&#121;", "y")
        txt = Replace(txt, "&#122;", "z")
        txt = Replace(txt, "&#123;", "{")
        txt = Replace(txt, "&#124;", "|")
        txt = Replace(txt, "&#125;", "}")
        txt = Replace(txt, "&#126;", "~")
        txt = Replace(txt, "&#153;", "™")
        txt = Replace(txt, "&#160;", "")
        txt = Replace(txt, "&#161;", "¡")
        txt = Replace(txt, "&#162;", "¢")
        txt = Replace(txt, "&#163;", "£")
        txt = Replace(txt, "&#164;", "¤")
        txt = Replace(txt, "&#165;", "¥")
        txt = Replace(txt, "&#166;", "¦")
        txt = Replace(txt, "&#167;", "§")
        txt = Replace(txt, "&#168;", "¨")
        txt = Replace(txt, "&#169;", "©")
        txt = Replace(txt, "&#170;", "ª")
        txt = Replace(txt, "&#171;", "«")
        txt = Replace(txt, "&#172;", "¬")
        txt = Replace(txt, "&#173;", "­")
        txt = Replace(txt, "&#174;", "®")
        txt = Replace(txt, "&#175;", "¯")
        txt = Replace(txt, "&#176;", "°")
        txt = Replace(txt, "&#177;", "±")
        txt = Replace(txt, "&#178;", "²")
        txt = Replace(txt, "&#179;", "³")
        txt = Replace(txt, "&#180;", "´")
        txt = Replace(txt, "&#181;", "µ")
        txt = Replace(txt, "&#182;", "¶")
        txt = Replace(txt, "&#183;", "·")
        txt = Replace(txt, "&#184;", "¸")
        txt = Replace(txt, "&#185;", "¹")
        txt = Replace(txt, "&#186;", "º")
        txt = Replace(txt, "&#187;", "»")
        txt = Replace(txt, "&#188;", "¼")
        txt = Replace(txt, "&#189;", "½")
        txt = Replace(txt, "&#190;", "¾")
        txt = Replace(txt, "&#191;", "¿")
        txt = Replace(txt, "&#192;", "À")
        txt = Replace(txt, "&#193;", "Á")
        txt = Replace(txt, "&#194;", "Â")
        txt = Replace(txt, "&#195;", "Ã")
        txt = Replace(txt, "&#196;", "Ä")
        txt = Replace(txt, "&#197;", "Å")
        txt = Replace(txt, "&#198;", "Æ")
        txt = Replace(txt, "&#199;", "Ç")
        txt = Replace(txt, "&#200;", "È")
        txt = Replace(txt, "&#201;", "É")
        txt = Replace(txt, "&#202;", "Ê")
        txt = Replace(txt, "&#203;", "Ë")
        txt = Replace(txt, "&#204;", "Ì")
        txt = Replace(txt, "&#205;", "Í")
        txt = Replace(txt, "&#206;", "Î")
        txt = Replace(txt, "&#207;", "Ï")
        txt = Replace(txt, "&#208;", "Ð")
        txt = Replace(txt, "&#209;", "Ñ")
        txt = Replace(txt, "&#210;", "Ò")
        txt = Replace(txt, "&#211;", "Ó")
        txt = Replace(txt, "&#212;", "Ô")
        txt = Replace(txt, "&#213;", "Õ")
        txt = Replace(txt, "&#214;", "Ö")
        txt = Replace(txt, "&#215;", "×")
        txt = Replace(txt, "&#216;", "Ø")
        txt = Replace(txt, "&#217;", "Ù")
        txt = Replace(txt, "&#218;", "Ú")
        txt = Replace(txt, "&#219;", "Û")
        txt = Replace(txt, "&#220;", "Ü")
        txt = Replace(txt, "&#221;", "Ý")
        txt = Replace(txt, "&#222;", "Þ")
        txt = Replace(txt, "&#223;", "ß")
        txt = Replace(txt, "&#224;", "à")
        txt = Replace(txt, "&#225;", "á")
        txt = Replace(txt, "&#226;", "â")
        txt = Replace(txt, "&#227;", "ã")
        txt = Replace(txt, "&#228;", "ä")
        txt = Replace(txt, "&#229;", "å")
        txt = Replace(txt, "&#230;", "æ")
        txt = Replace(txt, "&#231;", "ç")
        txt = Replace(txt, "&#232;", "è")
        txt = Replace(txt, "&#233;", "é")
        txt = Replace(txt, "&#234;", "ê")
        txt = Replace(txt, "&#235;", "ë")
        txt = Replace(txt, "&#236;", "ì")
        txt = Replace(txt, "&#237;", "í")
        txt = Replace(txt, "&#238;", "î")
        txt = Replace(txt, "&#239;", "ï")
        txt = Replace(txt, "&#240;", "ð")
        txt = Replace(txt, "&#241;", "ñ")
        txt = Replace(txt, "&#242;", "ò")
        txt = Replace(txt, "&#243;", "ó")
        txt = Replace(txt, "&#244;", "ô")
        txt = Replace(txt, "&#245;", "õ")
        txt = Replace(txt, "&#246;", "ö")
        txt = Replace(txt, "&#247;", "÷")
        txt = Replace(txt, "&#248;", "ø")
        txt = Replace(txt, "&#249;", "ù")
        txt = Replace(txt, "&#250;", "ú")
        txt = Replace(txt, "&#251;", "û")
        txt = Replace(txt, "&#252;", "ü")
        txt = Replace(txt, "&#253;", "ý")
        txt = Replace(txt, "&#254;", "þ")
        txt = Replace(txt, "&#255;", "ÿ")
        txt = Replace(txt, "&#32;", "")
        txt = Replace(txt, "&#33;", "!")
        txt = Replace(txt, "&#338;", "Œ")
        txt = Replace(txt, "&#339;", "œ")
        txt = Replace(txt, "&#34;", """")
        txt = Replace(txt, "&#35;", "#")
        txt = Replace(txt, "&#352;", "Š")
        txt = Replace(txt, "&#353;", "š")
        txt = Replace(txt, "&#36;", "$")
        txt = Replace(txt, "&#37;", "%")
        txt = Replace(txt, "&#372;", "Ŵ")
        txt = Replace(txt, "&#373;", "ŵ")
        txt = Replace(txt, "&#374;", "Ŷ")
        txt = Replace(txt, "&#375;", "ŷ")
        txt = Replace(txt, "&#376;", "Ÿ")
        txt = Replace(txt, "&#38;", "&")
        txt = Replace(txt, "&#39;", "'")
        txt = Replace(txt, "&#40;", "(")
        txt = Replace(txt, "&#402;", "ƒ")
        txt = Replace(txt, "&#41;", ")")
        txt = Replace(txt, "&#42;", "*")
        txt = Replace(txt, "&#43;", "+")
        txt = Replace(txt, "&#44;", ",")
        txt = Replace(txt, "&#45;", "-")
        txt = Replace(txt, "&#46;", ".")
        txt = Replace(txt, "&#47;", "/")
        txt = Replace(txt, "&#48;", "0")
        txt = Replace(txt, "&#49;", "1")
        txt = Replace(txt, "&#50;", "2")
        txt = Replace(txt, "&#51;", "3")
        txt = Replace(txt, "&#52;", "4")
        txt = Replace(txt, "&#53;", "5")
        txt = Replace(txt, "&#54;", "6")
        txt = Replace(txt, "&#55;", "7")
        txt = Replace(txt, "&#56;", "8")
        txt = Replace(txt, "&#57;", "9")
        txt = Replace(txt, "&#58;", ":")
        txt = Replace(txt, "&#59;", ";")
        txt = Replace(txt, "&#61;", "=")

        txt = Replace(txt, "&#63;", "?")
        txt = Replace(txt, "&#64;", "@")
        txt = Replace(txt, "&#65;", "A")
        txt = Replace(txt, "&#66;", "B")
        txt = Replace(txt, "&#67;", "C")
        txt = Replace(txt, "&#68;", "D")
        txt = Replace(txt, "&#69;", "E")
        txt = Replace(txt, "&#70;", "F")
        txt = Replace(txt, "&#71;", "G")
        txt = Replace(txt, "&#710;", "ˆ")
        txt = Replace(txt, "&#72;", "H")
        txt = Replace(txt, "&#73;", "I")
        txt = Replace(txt, "&#732;", "˜")
        txt = Replace(txt, "&#74;", "J")
        txt = Replace(txt, "&#75;", "K")
        txt = Replace(txt, "&#76;", "L")
        txt = Replace(txt, "&#77;", "M")
        txt = Replace(txt, "&#78;", "N")
        txt = Replace(txt, "&#7808;", "Ẁ")
        txt = Replace(txt, "&#7809;", "ẁ")
        txt = Replace(txt, "&#7810;", "Ẃ")
        txt = Replace(txt, "&#7811;", "ẃ")
        txt = Replace(txt, "&#7812;", "Ẅ")
        txt = Replace(txt, "&#7813;", "ẅ")
        txt = Replace(txt, "&#79;", "O")
        txt = Replace(txt, "&#7922;", "Ỳ")
        txt = Replace(txt, "&#7923;", "ỳ")
        txt = Replace(txt, "&#80;", "P")
        txt = Replace(txt, "&#81;", "Q")
        txt = Replace(txt, "&#8194;", " ")
        txt = Replace(txt, "&#8195;", " ")
        txt = Replace(txt, "&#82;", "R")
        txt = Replace(txt, "&#8201;", " ")
        txt = Replace(txt, "&#8204;", "‌")
        txt = Replace(txt, "&#8205;", "‍")
        txt = Replace(txt, "&#8206;", "‎")
        txt = Replace(txt, "&#8207;", "‏")
        txt = Replace(txt, "&#8211;", "–")
        txt = Replace(txt, "&#8212;", "—")
        txt = Replace(txt, "&#8216;", "‘")
        txt = Replace(txt, "&#8217;", "’")
        txt = Replace(txt, "&#8218;", "‚")
        txt = Replace(txt, "&#8220;", """")
        txt = Replace(txt, "&#8221;", """")
        txt = Replace(txt, "&#8222;", "„")
        txt = Replace(txt, "&#8224;", "†")
        txt = Replace(txt, "&#8225;", "‡")
        txt = Replace(txt, "&#8226;", "•")
        txt = Replace(txt, "&#8230;", "…")
        txt = Replace(txt, "&#8240;", "‰")
        txt = Replace(txt, "&#8242;", "′")
        txt = Replace(txt, "&#8243;", "″")
        txt = Replace(txt, "&#8249;", "‹")
        txt = Replace(txt, "&#8250;", "›")
        txt = Replace(txt, "&#8254;", "‾")
        txt = Replace(txt, "&#8260;", "⁄")
        txt = Replace(txt, "&#83;", "S")
        txt = Replace(txt, "&#8364;", "€")
        txt = Replace(txt, "&#84;", "T")
        txt = Replace(txt, "&#8465;", "ℑ")
        txt = Replace(txt, "&#8472;", "℘")
        txt = Replace(txt, "&#8476;", "ℜ")
        txt = Replace(txt, "&#8482;", "™")
        txt = Replace(txt, "&#85;", "U")
        txt = Replace(txt, "&#8501;", "ℵ")
        txt = Replace(txt, "&#8592;", "←")
        txt = Replace(txt, "&#8593;", "↑")
        txt = Replace(txt, "&#8594;", "→")
        txt = Replace(txt, "&#8595;", "↓")
        txt = Replace(txt, "&#8596;", "↔")
        txt = Replace(txt, "&#8597;", "↕")
        txt = Replace(txt, "&#86;", "V")
        txt = Replace(txt, "&#8629;", "↵")
        txt = Replace(txt, "&#8656;", "⇐")
        txt = Replace(txt, "&#8657;", "⇑")
        txt = Replace(txt, "&#8658;", "⇒")
        txt = Replace(txt, "&#8659;", "⇓")
        txt = Replace(txt, "&#8660;", "⇔")
        txt = Replace(txt, "&#87;", "W")
        txt = Replace(txt, "&#8704;", "∀")
        txt = Replace(txt, "&#8706;", "∂")
        txt = Replace(txt, "&#8707;", "∃")
        txt = Replace(txt, "&#8709;", "∅")
        txt = Replace(txt, "&#8711;", "∇")
        txt = Replace(txt, "&#8712;", "∈")
        txt = Replace(txt, "&#8713;", "∉")
        txt = Replace(txt, "&#8715;", "∋")
        txt = Replace(txt, "&#8719;", "∏")
        txt = Replace(txt, "&#8721;", "∑")
        txt = Replace(txt, "&#8722;", "−")
        txt = Replace(txt, "&#8727;", "∗")
        txt = Replace(txt, "&#8730;", "√")
        txt = Replace(txt, "&#8733;", "∝")
        txt = Replace(txt, "&#8734;", "∞")
        txt = Replace(txt, "&#8736;", "∠")
        txt = Replace(txt, "&#8743;", "∧")
        txt = Replace(txt, "&#8744;", "∨")
        txt = Replace(txt, "&#8745;", "∩")
        txt = Replace(txt, "&#8746;", "∪")
        txt = Replace(txt, "&#8747;", "∫")
        txt = Replace(txt, "&#8756;", "∴")
        txt = Replace(txt, "&#8764;", "∼")
        txt = Replace(txt, "&#8773;", "≅")
        txt = Replace(txt, "&#8776;", "≈")
        txt = Replace(txt, "&#88;", "X")
        txt = Replace(txt, "&#8800;", "≠")
        txt = Replace(txt, "&#8801;", "≡")
        txt = Replace(txt, "&#8804;", "≤")
        txt = Replace(txt, "&#8805;", "≥")
        txt = Replace(txt, "&#8834;", "⊂")
        txt = Replace(txt, "&#8835;", "⊃")
        txt = Replace(txt, "&#8836;", "⊄")
        txt = Replace(txt, "&#8838;", "⊆")
        txt = Replace(txt, "&#8839;", "⊇")
        txt = Replace(txt, "&#8853;", "⊕")
        txt = Replace(txt, "&#8855;", "⊗")
        txt = Replace(txt, "&#8869;", "⊥")
        txt = Replace(txt, "&#89;", "Y")
        txt = Replace(txt, "&#8901;", "⋅")
        txt = Replace(txt, "&#8968;", "⌈")
        txt = Replace(txt, "&#8969;", "⌉")
        txt = Replace(txt, "&#8970;", "⌊")
        txt = Replace(txt, "&#8971;", "⌋")
        txt = Replace(txt, "&#90;", "Z")
        txt = Replace(txt, "&#9001;", "〈")
        txt = Replace(txt, "&#9002;", "〉")
        txt = Replace(txt, "&#91;", "[")
        txt = Replace(txt, "&#913;", "Α")
        txt = Replace(txt, "&#914;", "Β")
        txt = Replace(txt, "&#915;", "Γ")
        txt = Replace(txt, "&#916;", "Δ")
        txt = Replace(txt, "&#917;", "Ε")
        txt = Replace(txt, "&#918;", "Ζ")
        txt = Replace(txt, "&#919;", "Η")
        txt = Replace(txt, "&#92;", "\")
        txt = Replace(txt, "&#920;", "Θ")
        txt = Replace(txt, "&#921;", "Ι")
        txt = Replace(txt, "&#922;", "Κ")
        txt = Replace(txt, "&#923;", "Λ")
        txt = Replace(txt, "&#924;", "Μ")
        txt = Replace(txt, "&#925;", "Ν")
        txt = Replace(txt, "&#926;", "Ξ")
        txt = Replace(txt, "&#927;", "Ο")
        txt = Replace(txt, "&#928;", "Π")
        txt = Replace(txt, "&#929;", "Ρ")
        txt = Replace(txt, "&#93;", "]")
        txt = Replace(txt, "&#931;", "Σ")
        txt = Replace(txt, "&#932;", "Τ")
        txt = Replace(txt, "&#933;", "Υ")
        txt = Replace(txt, "&#934;", "Φ")
        txt = Replace(txt, "&#935;", "Χ")
        txt = Replace(txt, "&#936;", "Ψ")
        txt = Replace(txt, "&#937;", "Ω")
        txt = Replace(txt, "&#938;", "Ϊ")
        txt = Replace(txt, "&#939;", "Ϋ")
        txt = Replace(txt, "&#94;", "^")
        txt = Replace(txt, "&#940;", "ά")
        txt = Replace(txt, "&#941;", "έ")
        txt = Replace(txt, "&#942;", "ή")
        txt = Replace(txt, "&#943;", "ί")
        txt = Replace(txt, "&#944;", "ΰ")
        txt = Replace(txt, "&#945;", "α")
        txt = Replace(txt, "&#946;", "β")
        txt = Replace(txt, "&#947;", "γ")
        txt = Replace(txt, "&#948;", "δ")
        txt = Replace(txt, "&#949;", "ε")
        txt = Replace(txt, "&#95;", "_")
        txt = Replace(txt, "&#950;", "ζ")
        txt = Replace(txt, "&#951;", "η")
        txt = Replace(txt, "&#952;", "θ")
        txt = Replace(txt, "&#953;", "ι")
        txt = Replace(txt, "&#954;", "κ")
        txt = Replace(txt, "&#955;", "λ")
        txt = Replace(txt, "&#956;", "μ")
        txt = Replace(txt, "&#957;", "ν")
        txt = Replace(txt, "&#958;", "ξ")
        txt = Replace(txt, "&#959;", "ο")
        txt = Replace(txt, "&#96;", "`")
        txt = Replace(txt, "&#960;", "π")
        txt = Replace(txt, "&#961;", "ρ")
        txt = Replace(txt, "&#962;", "ς")
        txt = Replace(txt, "&#963;", "σ")
        txt = Replace(txt, "&#964;", "τ")
        txt = Replace(txt, "&#965;", "υ")
        txt = Replace(txt, "&#966;", "φ")
        txt = Replace(txt, "&#967;", "χ")
        txt = Replace(txt, "&#9674;", "◊")
        txt = Replace(txt, "&#968;", "ψ")
        txt = Replace(txt, "&#969;", "ω")
        txt = Replace(txt, "&#97;", "a")
        txt = Replace(txt, "&#970;", "ϊ")
        txt = Replace(txt, "&#971;", "ϋ")
        txt = Replace(txt, "&#972;", "ό")
        txt = Replace(txt, "&#973;", "ύ")
        txt = Replace(txt, "&#974;", "ώ")
        txt = Replace(txt, "&#976;", "ϐ")
        txt = Replace(txt, "&#977;", "ϑ")
        txt = Replace(txt, "&#978;", "ϒ")
        txt = Replace(txt, "&#98;", "b")
        txt = Replace(txt, "&#982;", "ϖ")
        txt = Replace(txt, "&#9824;", "♠")
        txt = Replace(txt, "&#9827;", "♣")
        txt = Replace(txt, "&#9829;", "♥")
        txt = Replace(txt, "&#9830;", "♦")
        txt = Replace(txt, "&#99;", "c")
        txt = Replace(txt, "&#x152;", "Œ")
        txt = Replace(txt, "&#x153;", "œ")
        txt = Replace(txt, "&#x160;", "Š")
        txt = Replace(txt, "&#x161;", "š")
        txt = Replace(txt, "&#x174;", "Ŵ")
        txt = Replace(txt, "&#x175;", "ŵ")
        txt = Replace(txt, "&#x176;", "Ŷ")
        txt = Replace(txt, "&#x177;", "ŷ")
        txt = Replace(txt, "&#x178;", "Ÿ")
        txt = Replace(txt, "&#x192;", "ƒ")
        txt = Replace(txt, "&#x1e80;", "Ẁ")
        txt = Replace(txt, "&#x1e81;", "ẁ")
        txt = Replace(txt, "&#x1e82;", "Ẃ")
        txt = Replace(txt, "&#x1e83;", "ẃ")
        txt = Replace(txt, "&#x1e84;", "Ẅ")
        txt = Replace(txt, "&#x1e85;", "ẅ")
        txt = Replace(txt, "&#x1ef2;", "Ỳ")
        txt = Replace(txt, "&#x1ef3;", "ỳ")
        txt = Replace(txt, "&#x20;", "")
        txt = Replace(txt, "&#x2002;", " ")
        txt = Replace(txt, "&#x2003;", " ")
        txt = Replace(txt, "&#x2009;", " ")
        txt = Replace(txt, "&#x200c;", "‌")
        txt = Replace(txt, "&#x200d;", "‍")
        txt = Replace(txt, "&#x200e;", "‎")
        txt = Replace(txt, "&#x200f;", "‏")
        txt = Replace(txt, "&#x2013;", "–")
        txt = Replace(txt, "&#x2014;", "—")
        txt = Replace(txt, "&#x2018;", "‘")
        txt = Replace(txt, "&#x2019;", "’")
        txt = Replace(txt, "&#x201a;", "‚")
        txt = Replace(txt, "&#x201c;", """")
        txt = Replace(txt, "&#x201d;", """")
        txt = Replace(txt, "&#x201e;", "„")
        txt = Replace(txt, "&#x2020;", "†")
        txt = Replace(txt, "&#x2021;", "‡")
        txt = Replace(txt, "&#x2022;", "•")
        txt = Replace(txt, "&#x2026;", "…")
        txt = Replace(txt, "&#x2030;", "‰")
        txt = Replace(txt, "&#x2032;", "′")
        txt = Replace(txt, "&#x2033;", "″")
        txt = Replace(txt, "&#x2039;", "‹")
        txt = Replace(txt, "&#x203a;", "›")
        txt = Replace(txt, "&#x203e;", "‾")
        txt = Replace(txt, "&#x2044;", "⁄")
        txt = Replace(txt, "&#x20ac;", "€")
        txt = Replace(txt, "&#x21;", "!")
        txt = Replace(txt, "&#x2111;", "ℑ")
        txt = Replace(txt, "&#x2118;", "℘")
        txt = Replace(txt, "&#x211c;", "ℜ")
        txt = Replace(txt, "&#x2122;", "™")
        txt = Replace(txt, "&#x2135;", "ℵ")
        txt = Replace(txt, "&#x2190;", "→")
        txt = Replace(txt, "&#x2190;", "←")
        txt = Replace(txt, "&#x2191;", "↑")
        txt = Replace(txt, "&#x2192;", "→")
        txt = Replace(txt, "&#x2192;", "←")
        txt = Replace(txt, "&#x2193;", "↓")
        txt = Replace(txt, "&#x2194;", "↔")
        txt = Replace(txt, "&#x2195;;", "↕")
        txt = Replace(txt, "&#x21b5;", "↵")
        txt = Replace(txt, "&#x21d0;", "⇐")
        txt = Replace(txt, "&#x21d1;", "⇑")
        txt = Replace(txt, "&#x21d2;", "⇒")
        txt = Replace(txt, "&#x21d3;", "⇓")
        txt = Replace(txt, "&#x21d4;", "⇔")
        txt = Replace(txt, "&#x22;", """")
        txt = Replace(txt, "&#x2200;", "∀")
        txt = Replace(txt, "&#x2202;", "∂")
        txt = Replace(txt, "&#x2203;", "∃")
        txt = Replace(txt, "&#x2205;", "∅")
        txt = Replace(txt, "&#x2207;", "∇")
        txt = Replace(txt, "&#x2208;", "∈")
        txt = Replace(txt, "&#x2209;", "∉")
        txt = Replace(txt, "&#x220b;", "∋")
        txt = Replace(txt, "&#x220f;", "∏")
        txt = Replace(txt, "&#x2211;", "∑")
        txt = Replace(txt, "&#x2212;", "−")
        txt = Replace(txt, "&#x2217;", "∗")
        txt = Replace(txt, "&#x221a;", "√")
        txt = Replace(txt, "&#x221d;", "∝")
        txt = Replace(txt, "&#x221e;", "∞")
        txt = Replace(txt, "&#x2220;", "∠")
        txt = Replace(txt, "&#x2227;", "∧")
        txt = Replace(txt, "&#x2228;", "∨")
        txt = Replace(txt, "&#x2229;", "∩")
        txt = Replace(txt, "&#x222a;", "∪")
        txt = Replace(txt, "&#x222b;", "∫")
        txt = Replace(txt, "&#x2234;", "∴")
        txt = Replace(txt, "&#x223c;", "∼")
        txt = Replace(txt, "&#x2245;", "≅")
        txt = Replace(txt, "&#x2248;", "≈")
        txt = Replace(txt, "&#x2260;", "≠")
        txt = Replace(txt, "&#x2261;", "≡")
        txt = Replace(txt, "&#x2264;", "≤")
        txt = Replace(txt, "&#x2265;", "≥")
        txt = Replace(txt, "&#x2282;", "⊂")
        txt = Replace(txt, "&#x2283;", "⊃")
        txt = Replace(txt, "&#x2284;", "⊄")
        txt = Replace(txt, "&#x2286;", "⊆")
        txt = Replace(txt, "&#x2287;", "⊇")
        txt = Replace(txt, "&#x2295;", "⊕")
        txt = Replace(txt, "&#x2297;", "⊗")
        txt = Replace(txt, "&#x22a5;", "⊥")
        txt = Replace(txt, "&#x22c5;", "⋅")
        txt = Replace(txt, "&#x23;", "#")
        txt = Replace(txt, "&#x2308;", "⌈")
        txt = Replace(txt, "&#x2309;", "⌉")
        txt = Replace(txt, "&#x230a;", "⌊")
        txt = Replace(txt, "&#x230b;", "⌋")
        txt = Replace(txt, "&#x2329;", "〈")
        txt = Replace(txt, "&#x232a;", "〉")
        txt = Replace(txt, "&#x24;", "$")
        txt = Replace(txt, "&#x25;", "%")
        txt = Replace(txt, "&#x25ca;", "◊")
        txt = Replace(txt, "&#x26;", "&")
        txt = Replace(txt, "&#x262e;", "☮")
        txt = Replace(txt, "&#x262f;", "☯")
        txt = Replace(txt, "&#x263c;", "☼")
        txt = Replace(txt, "&#x263d;", "☽")
        txt = Replace(txt, "&#x263e;", "☾")
        txt = Replace(txt, "&#x2654;", "♔")
        txt = Replace(txt, "&#x2655;", "♕")
        txt = Replace(txt, "&#x2656;", "♖")
        txt = Replace(txt, "&#x2657", "♗")
        txt = Replace(txt, "&#x2658;", "♘")
        txt = Replace(txt, "&#x2659;", "♙")
        txt = Replace(txt, "&#x265a;", "♚")
        txt = Replace(txt, "&#x265b;", "♛")
        txt = Replace(txt, "&#x265c;", "♜")
        txt = Replace(txt, "&#x265d;", "♝")
        txt = Replace(txt, "&#x265e;", "♞")
        txt = Replace(txt, "&#x265f;", "♟")
        txt = Replace(txt, "&#x2660;", "♠")
        txt = Replace(txt, "&#x2663;", "♣")
        txt = Replace(txt, "&#x2665;", "♥")
        txt = Replace(txt, "&#x2666;", "♦")
        txt = Replace(txt, "&#x27;", "'")
        txt = Replace(txt, "&#x28;", "(")
        txt = Replace(txt, "&#x29;", ")")
        txt = Replace(txt, "&#x2a;", "*")
        txt = Replace(txt, "&#x2b;", "+")
        txt = Replace(txt, "&#x2c;", ",")
        txt = Replace(txt, "&#x2c6;", "ˆ")
        txt = Replace(txt, "&#x2d;", "-")
        txt = Replace(txt, "&#x2dc;", "˜")
        txt = Replace(txt, "&#x2e;", ".")
        txt = Replace(txt, "&#x2f;", "/")
        txt = Replace(txt, "&#x30;", "0")
        txt = Replace(txt, "&#x31;", "1")
        txt = Replace(txt, "&#x32;", "2")
        txt = Replace(txt, "&#x33;", "3")
        txt = Replace(txt, "&#x34;", "4")
        txt = Replace(txt, "&#x35;", "5")
        txt = Replace(txt, "&#x36;", "6")
        txt = Replace(txt, "&#x37;", "7")
        txt = Replace(txt, "&#x38;", "8")
        txt = Replace(txt, "&#x39;", "9")
        txt = Replace(txt, "&#x391;", "Α")
        txt = Replace(txt, "&#x392;", "Β")
        txt = Replace(txt, "&#x393;", "Γ")
        txt = Replace(txt, "&#x394;", "Δ")
        txt = Replace(txt, "&#x395;", "Ε")
        txt = Replace(txt, "&#x396;", "Ζ")
        txt = Replace(txt, "&#x397;", "Η")
        txt = Replace(txt, "&#x398;", "Θ")
        txt = Replace(txt, "&#x399;", "Ι")
        txt = Replace(txt, "&#x39a;", "Κ")
        txt = Replace(txt, "&#x39b;", "Λ")
        txt = Replace(txt, "&#x39c;", "Μ")
        txt = Replace(txt, "&#x39d;", "Ν")
        txt = Replace(txt, "&#x39e;", "Ξ")
        txt = Replace(txt, "&#x39f;", "Ο")
        txt = Replace(txt, "&#x3a;", ":")
        txt = Replace(txt, "&#x3a0;", "Π")
        txt = Replace(txt, "&#x3a1;", "Ρ")
        txt = Replace(txt, "&#x3a3;", "Σ")
        txt = Replace(txt, "&#x3a4;", "Τ")
        txt = Replace(txt, "&#x3a5;", "Υ")
        txt = Replace(txt, "&#x3a6;", "Φ")
        txt = Replace(txt, "&#x3a7;", "Χ")
        txt = Replace(txt, "&#x3a8;", "Ψ")
        txt = Replace(txt, "&#x3a9;", "Ω")
        txt = Replace(txt, "&#x3aa;", "Ϊ")
        txt = Replace(txt, "&#x3ab;", "Ϋ")
        txt = Replace(txt, "&#x3ac;", "ά")
        txt = Replace(txt, "&#x3ad;", "έ")
        txt = Replace(txt, "&#x3ae;", "ή")
        txt = Replace(txt, "&#x3af;", "ί")
        txt = Replace(txt, "&#x3b;", ";")
        txt = Replace(txt, "&#x3b0;", "ΰ")
        txt = Replace(txt, "&#x3b1;", "α")
        txt = Replace(txt, "&#x3b2;", "β")
        txt = Replace(txt, "&#x3b3;", "γ")
        txt = Replace(txt, "&#x3b4;", "δ")
        txt = Replace(txt, "&#x3b5;", "ε")
        txt = Replace(txt, "&#x3b6;", "ζ")
        txt = Replace(txt, "&#x3b7;", "η")
        txt = Replace(txt, "&#x3b8;", "θ")
        txt = Replace(txt, "&#x3b9;", "ι")
        txt = Replace(txt, "&#x3ba;", "κ")
        txt = Replace(txt, "&#x3bb;", "λ")
        txt = Replace(txt, "&#x3bc;", "μ")
        txt = Replace(txt, "&#x3bd;", "ν")
        txt = Replace(txt, "&#x3be;", "ξ")
        txt = Replace(txt, "&#x3bf;", "ο")

        txt = Replace(txt, "&#x3c0;", "π")
        txt = Replace(txt, "&#x3c1;", "ρ")
        txt = Replace(txt, "&#x3c2;", "ς")
        txt = Replace(txt, "&#x3c3;", "σ")
        txt = Replace(txt, "&#x3c4;", "τ")
        txt = Replace(txt, "&#x3c5;", "υ")
        txt = Replace(txt, "&#x3c6;", "φ")
        txt = Replace(txt, "&#x3c7;", "χ")
        txt = Replace(txt, "&#x3c8;", "ψ")
        txt = Replace(txt, "&#x3c9;", "ω")
        txt = Replace(txt, "&#x3ca;", "ϊ")
        txt = Replace(txt, "&#x3cb;", "ϋ")
        txt = Replace(txt, "&#x3cc;", "ό")
        txt = Replace(txt, "&#x3cd;", "ύ")
        txt = Replace(txt, "&#x3ce;", "ώ")
        txt = Replace(txt, "&#x3d;", "=")
        txt = Replace(txt, "&#x3d0;", "ϐ")
        txt = Replace(txt, "&#x3d1;", "ϑ")
        txt = Replace(txt, "&#x3d2;", "ϒ")
        txt = Replace(txt, "&#x3d6;", "ϖ")

        txt = Replace(txt, "&#x3f;", "?")
        txt = Replace(txt, "&#x40;", "@")
        txt = Replace(txt, "&#x41;", "A")
        txt = Replace(txt, "&#x42;", "B")
        txt = Replace(txt, "&#x43;", "C")
        txt = Replace(txt, "&#x44;", "D")
        txt = Replace(txt, "&#x45;", "E")
        txt = Replace(txt, "&#x46;", "F")
        txt = Replace(txt, "&#x47;", "G")
        txt = Replace(txt, "&#x48;", "H")
        txt = Replace(txt, "&#x49;", "I")
        txt = Replace(txt, "&#x4a;", "J")
        txt = Replace(txt, "&#x4b;", "K")
        txt = Replace(txt, "&#x4c;", "L")
        txt = Replace(txt, "&#x4d;", "M")
        txt = Replace(txt, "&#x4e;", "N")
        txt = Replace(txt, "&#x4f;", "O")
        txt = Replace(txt, "&#x50;", "P")
        txt = Replace(txt, "&#x51;", "Q")
        txt = Replace(txt, "&#x52;", "R")
        txt = Replace(txt, "&#x53;", "S")
        txt = Replace(txt, "&#x54;", "T")
        txt = Replace(txt, "&#x55;", "U")
        txt = Replace(txt, "&#x56;", "V")
        txt = Replace(txt, "&#x57;", "W")
        txt = Replace(txt, "&#x58;", "X")
        txt = Replace(txt, "&#x59;", "Y")
        txt = Replace(txt, "&#x5a;", "Z")
        txt = Replace(txt, "&#x5b;", "[")
        txt = Replace(txt, "&#x5c;", "\")
        txt = Replace(txt, "&#x5d;", "]")
        txt = Replace(txt, "&#x5e;", "^")
        txt = Replace(txt, "&#x5f;", "_")
        txt = Replace(txt, "&#x60;", "`")
        txt = Replace(txt, "&#x61;", "a")
        txt = Replace(txt, "&#x62;", "b")
        txt = Replace(txt, "&#x63;", "c")
        txt = Replace(txt, "&#x64;", "d")
        txt = Replace(txt, "&#x65;", "e")
        txt = Replace(txt, "&#x66;", "f")
        txt = Replace(txt, "&#x67;", "g")
        txt = Replace(txt, "&#x68;", "h")
        txt = Replace(txt, "&#x69;", "i")
        txt = Replace(txt, "&#x6a;", "j")
        txt = Replace(txt, "&#x6b;", "k")
        txt = Replace(txt, "&#x6c;", "l")
        txt = Replace(txt, "&#x6d;", "m")
        txt = Replace(txt, "&#x6e;", "n")
        txt = Replace(txt, "&#x6f;", "o")
        txt = Replace(txt, "&#x70;", "p")
        txt = Replace(txt, "&#x71;", "q")
        txt = Replace(txt, "&#x72;", "r")
        txt = Replace(txt, "&#x73;", "s")
        txt = Replace(txt, "&#x74;", "t")
        txt = Replace(txt, "&#x75;", "u")
        txt = Replace(txt, "&#x76;", "v")
        txt = Replace(txt, "&#x77;", "w")
        txt = Replace(txt, "&#x78;", "x")
        txt = Replace(txt, "&#x79;", "y")
        txt = Replace(txt, "&#x7a;", "z")
        txt = Replace(txt, "&#x7b;", "{")
        txt = Replace(txt, "&#x7c;", "|")
        txt = Replace(txt, "&#x7d;", "}")
        txt = Replace(txt, "&#x7e;", "~")
        txt = Replace(txt, "&#xa0;", "")
        txt = Replace(txt, "&#xa1;", "¡")
        txt = Replace(txt, "&#xa2;", "¢")
        txt = Replace(txt, "&#xa3;", "£")
        txt = Replace(txt, "&#xa4;", "¤")
        txt = Replace(txt, "&#xa5;", "¥")
        txt = Replace(txt, "&#xa6;", "¦")
        txt = Replace(txt, "&#xa7;", "§")
        txt = Replace(txt, "&#xa8;", "¨")
        txt = Replace(txt, "&#xa9;", "©")
        txt = Replace(txt, "&#xaa;", "ª")
        txt = Replace(txt, "&#xab;", "«")
        txt = Replace(txt, "&#xac;", "¬")
        txt = Replace(txt, "&#xad;", "­")
        txt = Replace(txt, "&#xae;", "®")
        txt = Replace(txt, "&#xaf;", "¯")
        txt = Replace(txt, "&#xb0;", "°")
        txt = Replace(txt, "&#xb1;", "±")
        txt = Replace(txt, "&#xb2;", "²")
        txt = Replace(txt, "&#xb3;", "³")
        txt = Replace(txt, "&#xb4;", "´")
        txt = Replace(txt, "&#xb5;", "µ")
        txt = Replace(txt, "&#xb6;", "¶")
        txt = Replace(txt, "&#xb7;", "·")
        txt = Replace(txt, "&#xb8;", "¸")
        txt = Replace(txt, "&#xb9;", "¹")
        txt = Replace(txt, "&#xba;", "º")
        txt = Replace(txt, "&#xbb;", "»")
        txt = Replace(txt, "&#xbc;", "¼")
        txt = Replace(txt, "&#xbd;", "½")
        txt = Replace(txt, "&#xbe;", "¾")
        txt = Replace(txt, "&#xbf;", "¿")
        txt = Replace(txt, "&#xc0;", "À")
        txt = Replace(txt, "&#xc1;", "Á")
        txt = Replace(txt, "&#xc2;", "Â")
        txt = Replace(txt, "&#xc3;", "Ã")
        txt = Replace(txt, "&#xc4;", "Ä")
        txt = Replace(txt, "&#xc5;", "Å")
        txt = Replace(txt, "&#xc6;", "Æ")
        txt = Replace(txt, "&#xc7;", "Ç")
        txt = Replace(txt, "&#xc8;", "È")
        txt = Replace(txt, "&#xc9;", "É")
        txt = Replace(txt, "&#xca;", "Ê")
        txt = Replace(txt, "&#xcb;", "Ë")
        txt = Replace(txt, "&#xcc;", "Ì")
        txt = Replace(txt, "&#xcd;", "Í")
        txt = Replace(txt, "&#xce;", "Î")
        txt = Replace(txt, "&#xcf;", "Ï")
        txt = Replace(txt, "&#xd0;", "Ð")
        txt = Replace(txt, "&#xd1;", "Ñ")
        txt = Replace(txt, "&#xd2;", "Ò")
        txt = Replace(txt, "&#xd3;", "Ó")
        txt = Replace(txt, "&#xd4;", "Ô")
        txt = Replace(txt, "&#xd5;", "Õ")
        txt = Replace(txt, "&#xd6;", "Ö")
        txt = Replace(txt, "&#xd7;", "×")
        txt = Replace(txt, "&#xd8;", "Ø")
        txt = Replace(txt, "&#xd9;", "Ù")
        txt = Replace(txt, "&#xda;", "Ú")
        txt = Replace(txt, "&#xdb;", "Û")
        txt = Replace(txt, "&#xdc;", "Ü")
        txt = Replace(txt, "&#xdd;", "Ý")
        txt = Replace(txt, "&#xde;", "Þ")
        txt = Replace(txt, "&#xdf;", "ß")
        txt = Replace(txt, "&#xe0;", "à")
        txt = Replace(txt, "&#xe1;", "á")
        txt = Replace(txt, "&#xe2;", "â")
        txt = Replace(txt, "&#xe3;", "ã")
        txt = Replace(txt, "&#xe4;", "ä")
        txt = Replace(txt, "&#xe5;", "å")
        txt = Replace(txt, "&#xe6;", "æ")
        txt = Replace(txt, "&#xe7;", "ç")
        txt = Replace(txt, "&#xe8;", "è")
        txt = Replace(txt, "&#xe9;", "é")
        txt = Replace(txt, "&#xea;", "ê")
        txt = Replace(txt, "&#xeb;", "ë")
        txt = Replace(txt, "&#xec;", "ì")
        txt = Replace(txt, "&#xed;", "í")
        txt = Replace(txt, "&#xee;", "î")
        txt = Replace(txt, "&#xef;", "ï")
        txt = Replace(txt, "&#xf0;", "ð")
        txt = Replace(txt, "&#xf1;", "ñ")
        txt = Replace(txt, "&#xf2;", "ò")
        txt = Replace(txt, "&#xf3;", "ó")
        txt = Replace(txt, "&#xf4;", "ô")
        txt = Replace(txt, "&#xf5;", "õ")
        txt = Replace(txt, "&#xf6;", "ö")
        txt = Replace(txt, "&#xf7;", "÷")
        txt = Replace(txt, "&#xf8;", "ø")
        txt = Replace(txt, "&#xf9;", "ù")
        txt = Replace(txt, "&#xfa;", "ú")
        txt = Replace(txt, "&#xfb;", "û")
        txt = Replace(txt, "&#xfc;", "ü")
        txt = Replace(txt, "&#xfd;", "ý")
        txt = Replace(txt, "&#xfe;", "þ")
        txt = Replace(txt, "&#xff;", "ÿ")
        txt = Replace(txt, "&Aacute;", "Á")
        txt = Replace(txt, "&aacute;", "á")
        txt = Replace(txt, "&Acirc;", "Â")
        txt = Replace(txt, "&acirc;", "â")
        txt = Replace(txt, "&acute;", "´")
        txt = Replace(txt, "&AElig;", "Æ")
        txt = Replace(txt, "&aelig;", "æ")
        txt = Replace(txt, "&Agrave;", "À")
        txt = Replace(txt, "&agrave;", "à")
        txt = Replace(txt, "&alefsym;", "ℵ")
        txt = Replace(txt, "&Alpha;", "Α")
        txt = Replace(txt, "&alpha;", "α")
        txt = Replace(txt, "&amp;", "&")
        txt = Replace(txt, "&and;", "∧")
        txt = Replace(txt, "&ang;", "∠")
        txt = Replace(txt, "&Aring;", "Å")
        txt = Replace(txt, "&aring;", "å")
        txt = Replace(txt, "&asymp;", "≈")
        txt = Replace(txt, "&Atilde;", "Ã")
        txt = Replace(txt, "&atilde;", "ã")
        txt = Replace(txt, "&Auml;", "Ä")
        txt = Replace(txt, "&auml;", "ä")
        txt = Replace(txt, "&bdquo;", "„")
        txt = Replace(txt, "&Beta;", "Β")
        txt = Replace(txt, "&beta;", "β")
        txt = Replace(txt, "&brvbar;", "¦")
        txt = Replace(txt, "&bull;", "•")
        txt = Replace(txt, "&cap;", "∩")
        txt = Replace(txt, "&Ccedil;", "Ç")
        txt = Replace(txt, "&ccedil;", "ç")
        txt = Replace(txt, "&cedil;", "¸")
        txt = Replace(txt, "&cent;", "¢")
        txt = Replace(txt, "&Chi;", "Χ")
        txt = Replace(txt, "&circ;", "ˆ")
        txt = Replace(txt, "&clubs;", "♣")
        txt = Replace(txt, "&cong;", "≅")
        txt = Replace(txt, "&copy;", "©")
        txt = Replace(txt, "&crarr;", "↵")
        txt = Replace(txt, "&cup;", "∪")
        txt = Replace(txt, "&curren;", "¤")
        txt = Replace(txt, "&dagger;", "†")
        txt = Replace(txt, "&Dagger;", "‡")
        txt = Replace(txt, "&darr;", "↓")
        txt = Replace(txt, "&dArr;", "⇓")
        txt = Replace(txt, "&deg;", "°")
        txt = Replace(txt, "&Delta;", "Δ")
        txt = Replace(txt, "&delta;", "δ")
        txt = Replace(txt, "&diams;", "♦")
        txt = Replace(txt, "&divide;", "÷")
        txt = Replace(txt, "&Eacute;", "É")
        txt = Replace(txt, "&eacute;", "é")
        txt = Replace(txt, "&Ecirc;", "Ê")
        txt = Replace(txt, "&ecirc;", "ê")
        txt = Replace(txt, "&Egrave;", "È")
        txt = Replace(txt, "&egrave;", "è")
        txt = Replace(txt, "&empty;", "∅")
        txt = Replace(txt, "&emsp;", " ")
        txt = Replace(txt, "&ensp;", " ")
        txt = Replace(txt, "&Epsilon;", "Ε")
        txt = Replace(txt, "&epsilon;", "ε")
        txt = Replace(txt, "&equiv;", "≡")
        txt = Replace(txt, "&Eta;", "Η")
        txt = Replace(txt, "&eta;", "η")
        txt = Replace(txt, "&ETH;", "Ð")
        txt = Replace(txt, "&eth;", "ð")
        txt = Replace(txt, "&Euml;", "Ë")
        txt = Replace(txt, "&euml;", "ë")
        txt = Replace(txt, "&euro;", "€")
        txt = Replace(txt, "&exist;", "∃")
        txt = Replace(txt, "&fnof;", "ƒ")
        txt = Replace(txt, "&forall;", "∀")
        txt = Replace(txt, "&frac12;", "½")
        txt = Replace(txt, "&frac14;", "¼")
        txt = Replace(txt, "&frac34;", "¾")
        txt = Replace(txt, "&frasl;", "⁄")
        txt = Replace(txt, "&Gamma;", "Γ")
        txt = Replace(txt, "&gamma;", "γ")
        txt = Replace(txt, "&ge;", "≥")

        txt = Replace(txt, "&harr;", "↔")
        txt = Replace(txt, "&hArr;", "⇔")
        txt = Replace(txt, "&hearts;", "♥")
        txt = Replace(txt, "&hellip;", "…")
        txt = Replace(txt, "&Iacute;", "Í")
        txt = Replace(txt, "&iacute;", "í")
        txt = Replace(txt, "&Icirc;", "Î")
        txt = Replace(txt, "&icirc;", "î")
        txt = Replace(txt, "&iexcl;", "¡")
        txt = Replace(txt, "&iexl;", "¡")
        txt = Replace(txt, "&Igrave;", "Ì")
        txt = Replace(txt, "&igrave;", "ì")
        txt = Replace(txt, "&image;", "ℑ")
        txt = Replace(txt, "&infin;", "∞")
        txt = Replace(txt, "&int;", "∫")
        txt = Replace(txt, "&Iota;", "Ι")
        txt = Replace(txt, "&iota;", "ι")
        txt = Replace(txt, "&iquest;", "¿")
        txt = Replace(txt, "&isin;", "∈")
        txt = Replace(txt, "&Iuml;", "Ï")
        txt = Replace(txt, "&iuml;", "ï")
        txt = Replace(txt, "&Kappa;", "Κ")
        txt = Replace(txt, "&kappa;", "κ")
        txt = Replace(txt, "&Lambda;", "Λ")
        txt = Replace(txt, "&lambda;", "λ")
        txt = Replace(txt, "&lang;", "〈")
        txt = Replace(txt, "&laquo;", "«")
        txt = Replace(txt, "&larr;", "←")
        txt = Replace(txt, "&lArr;", "⇐")
        txt = Replace(txt, "&lceil;", "⌈")
        txt = Replace(txt, "&ldquo;", """")
        txt = Replace(txt, "&le;", "≤")
        txt = Replace(txt, "&lfloor;", "⌊")
        txt = Replace(txt, "&lowast;", "∗")
        txt = Replace(txt, "&loz;", "◊")
        txt = Replace(txt, "&lrm;", "‎")
        txt = Replace(txt, "&lsaquo;", "‹")
        txt = Replace(txt, "&lsquo;", "‘")

        txt = Replace(txt, "&macr;", "¯")
        txt = Replace(txt, "&mdash;", "—")
        txt = Replace(txt, "&micro;", "µ")
        txt = Replace(txt, "&middot;", "·")
        txt = Replace(txt, "&minus;", "−")
        txt = Replace(txt, "&Mu;", "Μ")
        txt = Replace(txt, "&mu;", "μ")
        txt = Replace(txt, "&nabla;", "∇")
        txt = Replace(txt, "&nbsp;", "")
        txt = Replace(txt, "&ndash;", "–")
        txt = Replace(txt, "&ne;", "≠")
        txt = Replace(txt, "&ni;", "∋")
        txt = Replace(txt, "&not;", "¬")
        txt = Replace(txt, "&notin;", "∉")
        txt = Replace(txt, "&nsub;", "⊄")
        txt = Replace(txt, "&Ntilde;", "Ñ")
        txt = Replace(txt, "&ntilde;", "ñ")
        txt = Replace(txt, "&Nu;", "Ν")
        txt = Replace(txt, "&nu;", "ν")
        txt = Replace(txt, "&Oacute;", "Ó")
        txt = Replace(txt, "&oacute;", "ó")
        txt = Replace(txt, "&Ocirc;", "Ô")
        txt = Replace(txt, "&ocirc;", "ô")
        txt = Replace(txt, "&OElig;", "Œ")
        txt = Replace(txt, "&oelig;", "œ")
        txt = Replace(txt, "&Ograve;", "Ò")
        txt = Replace(txt, "&ograve;", "ò")
        txt = Replace(txt, "&oline;", "‾")
        txt = Replace(txt, "&Omega;", "Ω")
        txt = Replace(txt, "&omega;", "ω")
        txt = Replace(txt, "&Omicron;", "Ο")
        txt = Replace(txt, "&omicron;", "ο")
        txt = Replace(txt, "&oplus;", "⊕")
        txt = Replace(txt, "&or;", "∨")
        txt = Replace(txt, "&ordf;", "ª")
        txt = Replace(txt, "&ordm;", "º")
        txt = Replace(txt, "&Oslash;", "Ø")
        txt = Replace(txt, "&oslash;", "ø")
        txt = Replace(txt, "&Otilde;", "Õ")
        txt = Replace(txt, "&otilde;", "õ")
        txt = Replace(txt, "&otimes;", "⊗")
        txt = Replace(txt, "&Ouml;", "Ö")
        txt = Replace(txt, "&ouml;", "ö")
        txt = Replace(txt, "&para;", "¶")
        txt = Replace(txt, "&part;", "∂")
        txt = Replace(txt, "&permil;", "‰")
        txt = Replace(txt, "&perp;", "⊥")
        txt = Replace(txt, "&Phi;", "Φ")
        txt = Replace(txt, "&phi;", "φ")
        txt = Replace(txt, "&Pi;", "Π")
        txt = Replace(txt, "&pi;", "π")
        txt = Replace(txt, "&piv;", "ϖ")
        txt = Replace(txt, "&plusmn;", "±")
        txt = Replace(txt, "&pound;", "£")
        txt = Replace(txt, "&prime;", "′")
        txt = Replace(txt, "&Prime;", "″")
        txt = Replace(txt, "&prod;", "∏")
        txt = Replace(txt, "&prop;", "∝")
        txt = Replace(txt, "&Psi;", "Ψ")
        txt = Replace(txt, "&psi;", "ψ")
        txt = Replace(txt, "&quot;", """")
        txt = Replace(txt, "&radic;", "√")
        txt = Replace(txt, "&rang;", "〉")
        txt = Replace(txt, "&raquo;", "»")
        txt = Replace(txt, "&rarr;", "→")
        txt = Replace(txt, "&rArr;", "⇒")
        txt = Replace(txt, "&rceil;", "⌉")
        txt = Replace(txt, "&rdquo;", """")
        txt = Replace(txt, "&real;", "ℜ")
        txt = Replace(txt, "&reg;", "®")
        txt = Replace(txt, "&rfloor;", "⌋")
        txt = Replace(txt, "&Rho;", "Ρ")
        txt = Replace(txt, "&rho;", "ρ")
        txt = Replace(txt, "&rlm;", "‏")
        txt = Replace(txt, "&rsaquo;", "›")
        txt = Replace(txt, "&rsquo;", "’")
        txt = Replace(txt, "&sbquo;", "‚")
        txt = Replace(txt, "&Scaron;", "Š")
        txt = Replace(txt, "&scaron;", "š")
        txt = Replace(txt, "&sdot;", "⋅")
        txt = Replace(txt, "&sect;", "§")
        txt = Replace(txt, "&shy;", "­")
        txt = Replace(txt, "&Sigma;", "Σ")
        txt = Replace(txt, "&sigma;", "σ")
        txt = Replace(txt, "&sigmaf;", "ς")
        txt = Replace(txt, "&sim;", "∼")
        txt = Replace(txt, "&spades;", "♠")
        txt = Replace(txt, "&sub;", "⊂")
        txt = Replace(txt, "&sube;", "⊆")
        txt = Replace(txt, "&sum;", "∑")
        txt = Replace(txt, "&sup;", "⊃")
        txt = Replace(txt, "&sup1;", "¹")
        txt = Replace(txt, "&sup2;", "²")
        txt = Replace(txt, "&sup3;", "³")
        txt = Replace(txt, "&supe;", "⊇")
        txt = Replace(txt, "&szlig;", "ß")
        txt = Replace(txt, "&Tau;", "Τ")
        txt = Replace(txt, "&tau;", "τ")
        txt = Replace(txt, "&there4;", "∴")
        txt = Replace(txt, "&Theta;", "Θ")
        txt = Replace(txt, "&theta;", "θ")
        txt = Replace(txt, "&thetasym;", "ϑ")
        txt = Replace(txt, "&thinsp;", " ")
        txt = Replace(txt, "&THORN;", "Þ")
        txt = Replace(txt, "&thorn;", "þ")
        txt = Replace(txt, "&tilde;", "˜")
        txt = Replace(txt, "&times;", "×")
        txt = Replace(txt, "&trade;", "™")
        txt = Replace(txt, "&Uacute;", "Ú")
        txt = Replace(txt, "&uacute;", "ú")
        txt = Replace(txt, "&uarr;", "↑")
        txt = Replace(txt, "&uArr;", "⇑")
        txt = Replace(txt, "&Ucirc;", "Û")
        txt = Replace(txt, "&ucirc;", "û")
        txt = Replace(txt, "&Ugrave;", "Ù")
        txt = Replace(txt, "&ugrave;", "ù")
        txt = Replace(txt, "&uml;", "¨")
        txt = Replace(txt, "&upsih;", "ϒ")
        txt = Replace(txt, "&Upsilon;", "Υ")
        txt = Replace(txt, "&upsilon;", "υ")
        txt = Replace(txt, "&Uuml;", "Ü")
        txt = Replace(txt, "&uuml;", "ü")
        txt = Replace(txt, "&weierp;", "℘")
        txt = Replace(txt, "&Xi;", "Ξ")
        txt = Replace(txt, "&xi;", "ξ")
        txt = Replace(txt, "&Yacute;", "Ý")
        txt = Replace(txt, "&yacute;", "ý")
        txt = Replace(txt, "&yen;", "¥")
        txt = Replace(txt, "&yuml;", "ÿ")
        txt = Replace(txt, "&Yuml;", "Ÿ")
        txt = Replace(txt, "&Zeta;", "Ζ")
        txt = Replace(txt, "&zeta;", "ζ")
        txt = Replace(txt, "&zwj;", "‍")
        txt = Replace(txt, "&zwnj;", "‌")

        'txt = Replace(txt, "<br>", vbCrLf)

        'txt = Replace(txt, vbCrLf, "")
        'txt = Replace(txt, vbCr, "")
        'txt = Replace(txt, vbLf, "")
        'txt = Replace(txt, vbTab, "")

        Dim j As Integer = 1
        Do Until j >= Len(txt)
            If Mid(txt, j, 1) = "<" Then
L:
                Do Until Mid(txt, j, 1) = ">" Or j >= Len(txt)
                    txt = Strings.Left(txt, j - 1) & txt.Substring(j)
                Loop
                If j > Len(txt) Then j = Len(txt)
                If Not txt = "" Then
                    txt = Strings.Left(txt, j - 1) & txt.Substring(j)
                    j -= 1
                End If
                'ElseIf Mid(txt, j, 2) = "  " Then
                'txt = Strings.Left(txt, j - 1) & txt.Substring(j)
                'j -= 1
            End If
            j += 1
        Loop


        txt = Replace(txt, "&#60;", "<")
        txt = Replace(txt, "&#x3c;", "<")
        txt = Replace(txt, "&#62;", ">")
        txt = Replace(txt, "&gt;", ">")
        txt = Replace(txt, "&#x3e;", ">")
        txt = Replace(txt, "&lt;", "<")
        Return txt
    End Function
End Module
